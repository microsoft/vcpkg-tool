{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "id": "https://raw.githubusercontent.com/microsoft/vcpkg/master/scripts/vcpkg.schema.json",
    "title": "Vcpkg manifest",
    "description": "Vcpkg manifest file. See https://github.com/microsoft/vcpkg/blob/master/docs/specifications/manifests.md.",
    "definitions": {
        "identifier": {
            "description": "Identifiers used for feature names.",
            "allOf": [
                {
                    "description": "Identifier are lowercase with digits and dashes.",
                    "type": "string",
                    "pattern": "[a-z0-9]+(-[a-z0-9]+)*"
                },
                {
                    "not": {
                        "description": "Identifiers must not be a Windows filesystem or vcpkg reserved name.",
                        "type": "string",
                        "pattern": "^(prn|aux|nul|con|lpt[1-9]|com[1-9]|core|default)$"
                    }
                }
            ]
        },
        "platform-expression": {
            "description": "A specification of a set of platforms. See https://github.com/microsoft/vcpkg/blob/master/docs/specifications/manifests.md#definitions.",
            "type": "string"
        },
        "has-schemed-version": {
            "type": "object",
            "oneOf": [
                {
                    "properties": {
                        "version-string": {
                            "description": "Text used to identify an arbitrary version",
                            "type": "string",
                            "pattern": "^[^#]+$"
                        }
                    },
                    "required": [
                        "version-string"
                    ]
                },
                {
                    "properties": {
                        "version": {
                            "description": "A relaxed version string (1.2.3.4...)",
                            "type": "string",
                            "pattern": "^\\d+(\\.\\d+)*([+-].+)?$"
                        }
                    },
                    "required": [
                        "version"
                    ]
                },
                {
                    "properties": {
                        "version-semver": {
                            "description": "A semantic version string. See https://semver.org/",
                            "type": "string",
                            "pattern": "^\\d+\\.\\d+\\.\\d+([+-].+)?$"
                        }
                    },
                    "required": [
                        "version-semver"
                    ]
                },
                {
                    "properties": {
                        "version-date": {
                            "description": "A date version string (e.g. 2020-01-20)",
                            "type": "string",
                            "pattern": "^\\d{4}-\\d{2}-\\d{2}(\\.\\d+)*$"
                        }
                    },
                    "required": [
                        "version-date"
                    ]
                }
            ]
        },

        "artifact-registry": {
            "description": "An artifact registry backed by a git repository.",
            "properties": {
                "kind": {
                    "type": "string",
                    "pattern": "artifact"
                },
                "name": {
                    "$ref": "#/definitions/identifier"
                },
                "location": {
                    "type": "string",
                    "description": "A URI to the location of the artifact registry; typically a git URI."
                }
            },
            "required":["kind", "name", "location"]
        },
        },
        "settings": {
            "description": "A set of key/value pairs to sent in the environment when this node is evaluated.",
            "type": "object"
        },
        "artifact-references": {
            "description": "A key/value pair of artifact name to selected artifact version.",
            "type":"object",
            "minProperties":1,
            "patternProperties": {
                ".*": {
                    "type": "string"
                }
            }
        },
        "demands": {
            "description": "A set of filters to conditionally apply artifact pieces. Typically contains other 'requires' or 'see-also' or similar elements. The keys are platform expressions with identifiers assumed to refer to the host.",
            "type":"object",
            "patternProperties": {
                ".*": {
                    "type": "object",
                    "properties": {
                        "error": {
                            "type": "string",
                            "description": "An error message to print if this entry is evaluated."
                        },
                        "warning": {
                            "type": "string",
                            "description": "A warning message to print if this entry is evaluated."
                        },
                        "message": {
                            "type":"string",
                            "description": "A message to print if this entry is evaluated."
                        },
                        "apply": {
                            "type": "object"
                        },
                        "see-also": {
                            "description": "Suggested additional artifacts.",
                            "$ref": "#/definitions/artifact-references"
                        },
                        "requires": {
                            "description": "Artifacts that are required for this package to function.",
                            "$ref": "#/definitions/artifact-references"
                        },
                        "settings": {
                            "$ref": "#/definitions/settings"
                        }
                    }
                }
            }
        }
    },
    "type": "object",
    "allOf": [
        {
            "properties": {
                "name": {
                    "description": "The name of the top-level package",
                    "$ref": "#/definitions/package-name"
                },
                "version-string": {},
                "version": {},
                "version-date": {},
                "version-semver": {},
                "port-version": {
                    "$ref": "#/definitions/port-version"
                },
                "maintainers": {
                    "description": "An array of strings which contain the authors of a package",
                    "oneOf": [
                        {
                            "type": "array",
                            "items": {
                                "type": "string"
                            }
                        },
                        {
                            "type": "object",
                            "patternProperties": {
                                ".*": {
                                    "type":"object",
                                    "properties": {
                                        "email": {
                                            "type":"string",
                                            "description": "An email address to contact this contact."
                                        },
                                        "role": {
                                            "type": "string",
                                            "description": "An identifier indicating what kind of maintainer this person is."
                                        }
                                    }
                                }
                            }
                        }
                    ]
                },
                "summary": {
                    "description": "A shorter description of the port or project.",
                    "type": "string"
                },
                "description": {
                    "$ref": "#/definitions/description-field"
                },
                "homepage": {
                    "description": "A url which points to the homepage of a package.",
                    "type": "string",
                    "format": "uri"
                },
                "documentation": {
                    "description": "A url which points to the documentation of a package.",
                    "type": "string",
                    "format": "uri"
                },
                "license": {
                    "description": "An SPDX license expression at version 3.9.",
                    "type": "string"
                },
                "registries": {
                    "description": "A set of transitive artifact registries.",
                    "type":"array",
                    "items": {
                        "$ref":"#/definitions/artifact-registry"
                    }
                },
                "error": {
                    "type": "string",
                    "description": "An error message to print if this entry is evaluated."
                },
                "warning": {
                    "type": "string",
                    "description": "A warning message to print if this entry is evaluated."
                },
                "message": {
                    "type":"string",
                    "description": "A message to print if this entry is evaluated."
                },
                "apply": {
                    "type": "object",
                    "description": "used when we want to insert/copy contents from the artifact into the target project when they aren't there"
                },
                "see-also": {
                    "description": "Suggested additional artifacts.",
                    "$ref": "#/definitions/artifact-references"
                },
                "requires": {
                    "description": "Artifacts that are required for this package to function.",
                    "$ref": "#/definitions/artifact-references"
                },
                "settings": {
                    "$ref": "#/definitions/settings"
                },
                "demands": {
                    "$ref": "#/definitions/demands"
                }
            },
            "required": [
                "name"
            ],
            "patternProperties": {
                "^\\$": {}
            },
            "additionalProperties": false
        },
        {
            "$ref": "#/definitions/has-schemed-version"
        }
    ]
}
